<!doctype html>  
<html lang="en">  
<head>
  <link href="/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

  <link href="/css/party/sprite.css" rel="stylesheet">

  <style type="text/css">
    body, html{
      width: 100vw;
      height: 100vh;
      margin: 0px;
      padding: 0px;
    }
  </style>

</head>
<body>

  <!-- Party -->
  <div class="party">
  </div>

  <script src="/jquery/dist/jquery.min.js"></script>
  <script src="/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <script src="/js/sprite.js"></script>
  
  <script>  
    var socket = io.connect(':4200');

    var Generation = {};
    var partyID = window.location.pathname.split('/')[2];

    socket.on('connect', () =>
    {
      socket.emit('party', partyID);
      Seed();
    });

    socket.on('generation', (data) => 
    {
      Generation = data;
      $('head').append(`<link rel="stylesheet" type="text/css" href="/css/pokedex/generation-${data.id}/normal.css">`);
      if(data.hasShiny)
        $('head').append(`<link rel="stylesheet" type="text/css" href="/css/pokedex/generation-${data.id}/shiny.css">`);
    });

    socket.on('party', (data) => 
    {
      for(var key in data.party)
      {
        $(`.party #slot-${Number(key)+1}`).html("");

        if(data.party[key].pokemon)
        {
          $(`.party #slot-${Number(key)+1}`).html( SpriteDiv(data.generation, data.party[key].type, data.party[key].pokemon.id, data.party[key].name) );
        }
      }
    });
  </script>  

  <script type="text/javascript">
    // Seed party div
    function Seed()
    {
      $('.party').html("");
      for(var i = 1; i <= 6; i++)
      {
        $('.party').append(`
          <div class="col-xs-6 col-sm-4" id="slot-${i}"></div>
      `);
        if(i % 2 == 0)
          $('.party').append(`<div class="clearfix visible-xs"></div>`);
        if(i % 3 == 0)
          $('.party').append(`<div class="clearfix hidden-xs"></div>`);
      }
    }
  </script>

</body>
</html> 